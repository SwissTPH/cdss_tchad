{
  "forms": {},
  "schedules": [],
  "contact_summary": "var ContactSummary = {}; !function(e,t){if('object'==typeof exports&&'object'==typeof module)module.exports=t();else if('function'==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)('object'==typeof exports?exports:e)[r]=n[r]}}(ContactSummary,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&'object'==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,'default',{enumerable:!0,value:e}),2&t&&'string'!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,'a',t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p='',n(n.s=0)}([function(e,t,n){var r=n(1),o=n(5);e.exports=o(r,contact,reports)},function(e,t,n){const{getImmChildFileds:r,generateChildContext:o,getImmWomenFileds:a,generateWomenContext:i,getAgeInMonths:s,isAlive:c,getAgeInYears:u}=n(2),p=contact,l=lineage,f=reports,d=[{appliesToType:'person',label:'patient_id',value:p.patient_id,width:4},{appliesToType:'person',label:'contact.age',value:p.date_of_birth,width:4,filter:'age'},{appliesToType:'person',label:'contact.sex',value:'contact.sex.'+p.sex,translate:!0,width:4},{appliesToType:'person',label:'person.field.phone',value:p.phone,width:4},{appliesToType:'person',label:'person.field.alternate_phone',value:p.phone_alternate,width:4},{appliesToType:'person',label:'External ID',value:p.external_id,width:4},{appliesToType:'person',label:'contact.parent',value:l,filter:'lineage'},{appliesToType:'!person',label:'contact',value:p.contact&&p.contact.name,width:4},{appliesToType:'!person',label:'contact.phone',value:p.contact&&p.contact.phone,width:4},{appliesToType:'!person',label:'External ID',value:p.external_id,width:4},{appliesToType:'!person',appliesIf:function(){return p.parent&&l[0]},label:'contact.parent',value:l,filter:'lineage'},{appliesToType:'person',label:'contact.notes',value:p.notes,width:12},{appliesToType:'!person',label:'contact.notes',value:p.notes,width:12}];p.short_name&&d.unshift({appliesToType:'person',label:'contact.short_name',value:p.short_name,width:4});const _={alive:c(p),muted:!1},m=[];m.push({label:'contact.profile.imm.child',appliesTo:'contacts',appliesToType:'person',appliesIf:function(){return s()<18},fields:r(f),modifyContext:o}),m.push({label:'contact.profile.imm.women',appliesTo:'contacts',appliesToType:'person',appliesIf:function(){return'female'===contact.sex&&(!contact.date_of_birth||u(contact)>=10)},fields:a(f),modifyContext:i}),e.exports={fields:d,cards:m,context:_}},function(e,t,n){const{injectDataFromForm:r,isReportValid:o,getAgeInYears:a,dateFormat:i,isDate:s,hasValue:c,getBirthDate:u,count:p}=n(3),{isAlive:l}=n(4);var f=Date.now(),d=['cpn'],_=['pev_enfant'],m=['pev_femme'],v=[['vat1','vat1'],['vat2','vat2'],['vat3','vat3'],['vat4','vat4'],['vat5','vat5']],h=['vat'],g=['p_faf','p_moustiquaire','p_tpi','p_deparasitage','p_conseils','p_hygiene','p_info','p_ptme','p_vih','p_autre_mesr','s_saignement','s_leucorrhee','s_perte','s_cephale','s_convulsion','s_respiration','s_essoufflement','s_fievre','s_douleur','s_mains','s_toux','s_pertes_vaginales','s_contraction_uterine','s_rupture_poche','s_lieu_accouche','lieu_accouche','s_moyen_transport','moyen_transport','s_economie','s_preneurs_decisions','preneurs_decisions','s_donneurs_sang','donneurs_sang','s_id_accompagnate','id_accompagnate_note','s_necessaires','diabete','drepanocytose','cardiopathie','hypertension_ateriel','tuberculose','autre','sign_antecedent','p_int_cpn','date_cpn_1','missed_cpn_1','date_cpn_2','missed_cpn_2','date_cpn_3','missed_cpn_3','date_cpn_4','missed_cpn_4','date_cpn_5','missed_cpn_5','date_cpn_6','missed_cpn_6','date_cpn_7','missed_cpn_7','date_cpn_8','missed_cpn_8','r_test_grossesse','t_test_grossesse','affi_method','ddr_date','dpa_date','no_info_pregnancy_reason','age_estima','label_esti'],y=[['bcg','bcg'],['vpo0','vpo0'],['vpo1','vpo1'],['vpo2','vpo2'],['vpo3','vpo3'],['penta1','penta1'],['penta2','penta2'],['penta3','penta3'],['vpi','vpi'],['var','var'],['vaa','vaa'],['meni','meni'],['vita','vita'],['meb','meb']],b=['bcg','vpo','penta','vpi','var','vaa','meni','vita','meb'];function D(e,t,n){var r,o={};for(t.forEach((function(e){o[e[0]]=null})),r=0;r<e.length;++r){const a=e[r];a&&n.includes(a.form)&&a.fields&&I(o,a.fields,t)}return o}function w(e,t,n,r){const o=[];var a=D(e,t,n);return r.forEach((function(e){var n,r={label:'contact.imm.'+e,translate:!0,width:6};if(A(e,t))r.value=c(a[e])&&s(a[e])?i(a[e]):null;else{let o=N(a,e,t);r.value='faite: '+N(a,e,t)+'\\nattendue: '+(n=e,p(t,(function(e){return 0===e[0].indexOf(n)}))),o>0&&(r.value+='\\nderniÃ¨re: '+i(function(e,t){var n=function(e,t){return Object.fromEntries(Object.entries(e).filter(([e,n])=>0===e.indexOf(t)&&s(n)))}(e,t);return Object.keys(n).length>0?Math.max.apply(null,Object.keys(n).map((function(e){return n[e]}))):null}(a,e)))}o.push(r)})),o}const T=reports;function x(e,t,n){var r=D(T,t,n);Object.entries(r).forEach(([t,n])=>{null!==n&&(e['imm_date_'+t]=s(n)?i(n,!0):n)})}var I=function(e,t,n){n.forEach((function(n){!e[n[0]]&&c(t['date_'+n[0]])&&(e[n[0]]=Date.parse(t['date_'+n[0]]))}))};var N=function(e,t,n){return p(n,(function(n){return e[n[0]]&&0===n[0].indexOf(t)}))};var A=function(e,t){return t.some((function(t){return t[0]===e}))};e.exports={now:f,pregnancyForms:[],deliveryForms:[],postnatalForms:[],MS_IN_DAY:864e5,MAX_DAYS_IN_PREGNANCY:308,DAYS_IN_PNC:45,generateWomenContext:function(e){x(e,v,m),r(e,'cpn_',g,d,reports)},generateChildContext:function(e){x(e,y,_)},count:p,getBirthDate:u,isReportValid:o,countReportsSubmittedInWindow:function(e,t){return p(reports,(function(n){return n.reported_date<=t&&-1!==e.indexOf(n.form)}))},addDate:function(e,t){var n=new Date(e);return e.setDate(n.getDate()+t),e},isDate:s,isAlive:l,getOldestReport:function(e){var t;return e.forEach((function(e){o(e)&&(!t||e.reported_date<t.reported_date)&&(t=e)})),t},getAgeInMonths:function(){var e,t;if(contact.date_of_birth&&''!==contact.date_of_birth)return e=new Date(contact.date_of_birth),t=new Date(Date.now()-e.getTime()),12*Math.abs(t.getFullYear()-1970)+t.getMonth()},generateImmContext:x,getAgeInYears:a,getImmChildFileds:function(e){return w(e,y,_,b)},getImmWomenFileds:function(e){return w(e,v,m,h)}}},function(e,t){function n(e,t,n){var o,a={};for(t.forEach((function(e){a[e[0]]=null})),o=0;o<e.length;++o){const i=e[o];i&&n.includes(i.form)&&i.fields&&(a=r(a,i.fields,t))}return a}function r(e,t,n){for(const[o,a]of Object.entries(t))isNaN(o)&&null!=a&&'meta'!==o&&void 0!==o&&('object'==typeof a&&Object.getOwnPropertyNames(a).length>0?e=r(e,a,n):n.includes(o)&&(e[o]=a));return e}e.exports={dateFormat:function(e,t=!1){let n=new Date(e),r=n.getDate(),o=n.getMonth()+1,a=n.getFullYear();return t?`${a}-${o}-${r}`:`${r}/${o}/${a}`},getAgeInYears:function(e){var t,n;if(e.date_of_birth&&''!==e.date_of_birth)return t=new Date(e.date_of_birth),n=new Date(Date.now()-t.getTime()),Math.abs(n.getFullYear()-1970)},addDatas:r,initDatas:n,isReportValid:function(e){return e&&!(e.errors&&e.errors.length)},injectDataFromForm:function(e,t,r,o,a=[]){var i=n(a,r,o);Object.entries(i).forEach(([n,r])=>{null!==r&&(e[t+n]=r)})},isDate:function(e){return null!=e&&'Invalid Date'!==new Date(e)&&!isNaN(new Date(e))},hasValue:function(e){return null!=e&&''!==e},getBirthDate:function(e){var t=e&&(e.birth_date||e.fields.birth_date||e.reported_date);return new Date(t)},count:function(e,t){for(var n=0,r=0;r<e.length;++r)t(e[r])&&++n;return n},truncateDecimals:function(e,t){var n=e.toString(),r=n.indexOf('.'),o=-1===r?n.length:1+r+t,a=n.substr(0,o),i=isNaN(a)?0:a;return parseFloat(i)}}},function(e,t){const n=l(Date.now()),r=['pregnancy'],o=['delivery'],a=['pregnancy_home_visit'],i=['pregnancy','pregnancy_home_visit','pregnancy_facility_visit_reminder','pregnancy_danger_sign','pregnancy_danger_sign_follow_up','delivery'];const s=(e,t)=>['fields',...(t||'').split('.')].reduce((e,t)=>{if(void 0!==e)return e[t]},e);function c(e,t){let n;return e.forEach((function(e){t.includes(e.form)&&!e.deleted&&(!n||e.reported_date>n.reported_date)&&(n=e)})),n}function u(e){if(!e)return new Date;const t=e.split(/\\D/),n=new Date(t[0],t[1]-1,t[2]);return function(e){return e instanceof Date&&!isNaN(e)}(n)?n:new Date}function p(e){const t=new Date(e);return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t}function l(e){if('string'==typeof e){if(''===e)return null;e=u(e)}return p(e).getTime()}function f(e,t){const n=p(new Date(e));return n.setDate(n.getDate()+t),n}function d(e){return r.includes(e.form)}function _(e){return a.includes(e.form)}const m=function(e,t){let n;return e.forEach((function(e){t.includes(e.form)&&(!n||e.reported_date>n.reported_date)&&(n=e)})),n},v=function(e){return d(e)&&l(s(e,'lmp_date_8601'))};function h(e,t){return e.reports.filter((function(e){let n=v(t);return n||(n=t.reported_date),_(e)&&e.reported_date>t.reported_date&&e.reported_date<f(n,294)}))}function g(e,t){let n=v(t),r=t.reported_date;return h(e,t).forEach((function(e){const t=function(e){return _(e)&&l(s(e,'lmp_date_8601'))}(e);e.reported_date>r&&''!==t&&t!==n&&(r=e.reported_date,n=t)})),n}e.exports={today:n,MS_IN_DAY:864e5,MAX_DAYS_IN_PREGNANCY:294,addDays:f,isAlive:function(e){return e&&e.contact&&!e.contact.date_of_death},getTimeForMidnight:p,isFormArraySubmittedInWindow:function(e,t,n,r,o){let a=!1,i=0;return e.forEach((function(e){t.includes(e.form)&&e.reported_date>=n&&e.reported_date<=r&&(a=!0,o&&i++)})),o?i>=o:a},isFormArraySubmittedInWindowExcludingThisReport:function(e,t,n,r,o,a){let i=!1,s=0;return e.forEach((function(e){t.includes(e.form)&&e.reported_date>=n&&e.reported_date<=r&&e._id!==o._id&&(i=!0,a&&s++)})),a?s>=a:i},getDateMS:l,getDateISOLocal:u,isDeliveryForm:function(e){return o.includes(e.form)},getMostRecentReport:c,getNewestPregnancyTimestamp:function(e){if(!e.contact)return;const t=c(e.reports,'pregnancy');return t?t.reported_date:0},getNewestDeliveryTimestamp:function(e){if(!e.contact)return;const t=c(e.reports,'delivery');return t?t.reported_date:0},getReportsSubmittedInWindow:function(e,t,n,r,o){const a=[];return e.forEach((function(e){t.includes(e.form)&&e.reported_date>=n&&e.reported_date<=r&&(o&&!o(e)||a.push(e))})),a},countReportsSubmittedInWindow:function(e,t,n,r,o){let a=0;return e.forEach((function(e){t.includes(e.form)&&e.reported_date>=n&&e.reported_date<=r&&(o&&!o(e)||a++)})),a},countANCFacilityVisits:function(e,t){let n=0;const r=h(e,t);return s(t,'anc_visits_hf.anc_visits_hf_past')&&!isNaN(s(t,'anc_visits_hf.anc_visits_hf_past.visited_hf_count'))&&(n+=parseInt(s(t,'anc_visits_hf.anc_visits_hf_past.visited_hf_count'))),n+=r.reduce((function(e,t){const n=s(t,'anc_visits_hf.anc_visits_hf_past');return n?(e+='yes'===n.last_visit_attended&&1,isNaN(n.visited_hf_count)?e:e+('yes'===n.report_other_visits&&parseInt(n.visited_hf_count))):0}),0),n},isFacilityDelivery:function(e,t){return!!e&&(1===arguments.length&&(t=e),'yes'===s(t,'facility_delivery'))},getMostRecentLMPDateForPregnancy:g,getNewestReport:m,getSubsequentPregnancyFollowUps:h,isActivePregnancy:function(e,t){if(!d(t))return!1;const r=(g(e,t)||t.reported_date)>n-254016e5,o=function(e,t,r){return e.reports.filter((function(e){return'delivery'===e.form&&e.reported_date>t.reported_date&&(!r||t.reported_date>=n-864e5*r)}))}(e,t,42).length>0,i=function(e,t){return e.reports.filter((function(e){return d(e)&&e.reported_date>t.reported_date}))}(e,t).length>0;return r&&!o&&!i&&!function(e,t){const n=h(e,t),r=m(n,a);return r&&'abortion'===s(r,'pregnancy_summary.visit_option')}(e,t)&&!function(e,t){const n=h(e,t),r=m(n,a);return r&&'miscarriage'===s(r,'pregnancy_summary.visit_option')}(e,t)},getRecentANCVisitWithEvent:function(e,t,n){const r=h(e,t),o=m(r,a);if(o&&s(o,'pregnancy_summary.visit_option')===n)return o},isPregnancyTaskMuted:function(e){const t=m(e.reports,i);return t&&_(t)&&'clear_all'===s(t,'pregnancy_ended.clear_option')},getField:s,getConditionValue:function(e,t,n){if(s(t,n)){const e=s(t,n).valueOf();return parseInt(e)}},hasCondition:function(e,t,n){if(s(t,n)){const e=s(t,n).valueOf();return'1'===e||'yes'===e.toLowerCase()}return!1}}},function(e,t){function n(e){return e?Array.isArray(e)?e:[e]:[]}function r(e,t){switch(typeof e){case'undefined':return!0;case'function':return e(t);default:return e}}function o(e,t,n){if(r(e.appliesIf,n)){var o='function'==typeof e.fields?e.fields(n):e.fields.filter((function(e){return r(e.appliesIf,n)})).map((function(e){var t={};return a(e,t,'label'),a(e,t,'value'),a(e,t,'translate'),a(e,t,'filter'),a(e,t,'width'),a(e,t,'icon'),e.context&&(t.context={},a(e.context,t.context,'count'),a(e.context,t.context,'total')),t}));return e.modifyContext&&e.modifyContext(t,n),{label:e.label,fields:o}}function a(e,t,r){switch(typeof e[r]){case'undefined':return;case'function':t[r]=e[r](n);break;default:t[r]=e[r]}}}e.exports=function(e,t,r){var a=e.fields||[],i=e.context||{},s=e.cards||[],c=t&&('contact'===t.type?t.contact_type:t.type),u={cards:[],fields:a.filter((function(e){var t=n(e.appliesToType),r=t.filter((function(e){return e&&'!'===e.charAt(0)}));if((0===t.length||t.includes(c)||r.length>0&&!r.includes('!'+c))&&(!e.appliesIf||e.appliesIf()))return delete e.appliesToType,delete e.appliesIf,!0}))};return s.forEach((function(e){var t,a,s,p,l=n(e.appliesToType);if(l.includes('report')&&l.length>1)throw new Error('You cannot set appliesToType to an array which includes the type \\'report\\' and another type.');if(l.includes('report'))for(t=0;t<r.length;++t)a=r[t],!(p=a)||p.errors&&p.errors.length||(s=o(e,i,a))&&u.cards.push(s);else{if(!l.includes(c)&&l.length>0)return;(s=o(e,i))&&u.cards.push(s)}})),u.context=i,u}}])})); return ContactSummary;",
  "tasks": {
    "rules": "define Target { _id: null, contact: null, deleted: null, type: null, pass: null, date: null, groupBy: null }\ndefine Contact { contact: null, reports: null, tasks: null }\ndefine Task { _id: null, deleted: null, doc: null, contact: null, icon: null, date: null, readyStart: null, readyEnd: null, title: null, fields: null, resolved: null, priority: null, priorityLabel: null, reports: null, actions: null }\nrule GenerateEvents {\n  when { c: Contact } then { !function(e){var t={};function _(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,_),r.l=!0,r.exports}_.m=e,_.c=t,_.d=function(e,t,i){_.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},_.r=function(e){'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})},_.t=function(e,t){if(1&t&&(e=_(e)),8&t)return e;if(4&t&&'object'==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(_.r(i),Object.defineProperty(i,'default',{enumerable:!0,value:e}),2&t&&'string'!=typeof e)for(var r in e)_.d(i,r,function(t){return e[t]}.bind(null,r));return i},_.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return _.d(t,'a',t),t},_.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},_.p='',_(_.s=1)}([function(e,t){e.exports=function(e){var t={};!function e(t,_){var i=Object.keys(t);for(var r in i){var n=i[r];switch(typeof t[n]){case'object':e(t[n],_);break;case'function':t[n]=t[n].bind(_)}}}(e,t),t.definition=function e(t){var _=Object.assign({},t),i=Object.keys(_);for(var r in i){var n=i[r];if(Array.isArray(_[n])){_[n]=_[n].slice(0);for(var a=0;a<_[n].length;++a)'object'==typeof _[n][a]&&(_[n][a]=e(_[n][a]))}else'object'==typeof _[n]&&(_[n]=e(_[n]))}return _}(e)}},function(e,t,_){var i=_(2),r=_(6),n=_(7);_(9)(r,c,Utils,Target,emit),n(i,c,Utils,Task,emit),emit('_complete',{_id:!0})},function(e,t,_){const{generateIMCIContent:i,TASK_FORM:r,IMCI_FORMS:n,IMCIresolveIf:a}=_(3);e.exports=[{name:'tchad_form_pause',icon:'icon-followup-general',title:'Continue after lab',appliesTo:'reports',appliesToType:n,actions:[{type:'report',form:r,modifyContent:i}],events:[{id:'tchad_form_pause',days:1,start:1,end:0}],resolvedIf:a}]},function(e,t,_){const{injectDataFromForm:i}=_(4),{getField:r,addDays:n}=_(5),a=['imci_interogation'],s=['p_sel_gender','p_age','p_weight','p_weight_age','p_weight_class','d_convulsion','d_convulsion_epi','a_iv_possible','a_ng_tube_possible_ds','d_malnutrition_severe_complex','d_malnutrition_severe_simple','d_malnutrition_severe_possible','d_malnutrition_moderate','d_malnutrition_cannot_assess','d_malnutrition_none','d_malnutrition_severe','d_ictere','d_anemia_moderate_to_test','d_anemia_severe_to_test','d_anemia_severe_possible','d_anemia_severe','d_anemia_moderate','as_meningitis','d_cellulite_erysipelas_refer','d_abscess_refer','d_abscess','d_boils_or_small_abscess','d_cellulite_erysipelas','d_meningococcal_septicemia_possible','d_skin_problem_no_category','d_seborrhoeic_dermatitis','d_ringworm_head','d_kerion','d_head_lice','d_impetigo','d_impetigo_extensive','d_herpes','d_body_ringworm_localised','d_folliculitis','d_ulcer_refer','d_ulcere','d_dracunculiasis','d_lepre_possible','d_pityriasis_versicolour','d_pityriasis_alba','d_molloscum_contagiosum','d_zona','d_meningococcal_scepticism_possible','d_varicella','d_varicella_superinfected','d_fever_scarlet','d_benign_viral_rash_possible','d_urticaria','d_scabies','d_scabies_superinfected','d_body_ringworm_extensive','d_eczema_extensive','d_eczema','d_eczema_extensive_superinfected','d_skin_problem_not_diagnosed','d_vision_loss','d_eye_injury','d_orbital_cellulitis','d_preseptal_cellulitis','d_simple_headache','d_serious_brain_problem','d_referral_head','d_migraine','d_simple_head_trauma','d_flu','d_simple_headache_sinusitis_viral','d_sinusitis_bacterial','d_ear_infection_to_treat','d_mastoidity','d_ear_infection_w_discharge','d_ear_infection_chronic','d_ear_infection','d_ear_wax','d_ear_severe_head_trauma','d_ear_foreign_obj','d_ear_other','d_epilepsy_known','d_postictal_state','d_epilepsy_likely','d_convulsion_with_febrile_sickness','d_first_convulsion_non_febrile','d_upper_resp_infection_severe','d_angina_possible','d_angina_to_test','d_angina','d_pharyngitis_viral','d_oral_candida','d_eruption_tooth','d_dental_cavity','d_oral_ulcer','d_viral_infection_oral','d_gingivite','d_oral_trauma','d_oral_trauma_severe','d_dental_abscess','d_dental_abscess_possible','d_mastoiditis','d_foreign_body','d_circumcision_infection','d_hemorrhage_vaginale_observe','d_possible_start_of_period','as_is_vaginal_discharge','d_urine_test_f','d_urine_test_m','as_is_red_swollen_tender_testicles','as_is_bloody_urine_or_hematoria_history','as_is_ulceration_or_irritation','as_is_mucopurulent_discharge_m','d_testicular_torsion_probably','d_testicular_infection_treat','d_post_circumcision_infection_probable','d_balanitis','d_urethritis','d_lower_urinary_tract_infection','as_is_suspicion_lower_urinary_tract_infection','d_pyelonephritis','d_urin_retention','d_anuria','d_anuria_referral','d_trauma_genital','d_diaper_rash','d_bilharzia_to_test','d_vesical_bilharzia','d_hematuria_persistent','d_kidney_problem_post_streptococcal_infection_posible','d_sickle_cell_disease_possible','d_hematuria_observe','as_is_hiv_test_irritation_ulcerations','d_herpes_genital_observe','d_syphilis_and_chancre_mou','d_oxyure_and_candida_likely','d_candida','d_genital_discharge_observe','d_dehydration_severe','d_dehydration','d_upper_resp_infection','d_herpetic_keratitis','d_trachoma_possible','d_cornea_abrasion_possible','d_measles_past','d_measles_severe_complex','d_measles_complex','d_measles','d_measles_present_past','d_measles_mouth_ulcers','d_ano_rectal_cleft','d_hemorrhoids','d_rectal_prolapse','d_stool_blood','d_stool_blood_episode','d_intoxication_high_risk_refer','d_ingestion_non_complicated','d_intoxication_substance_unknown','d_intoxication_alcoholic','as_substance_ingired','d_selfagression_suicide_likely','d_agression_suicide_unlikely','d_emotional_and_substance_use_management','d_agression_suicide_none','dgh_antiparasites','d_hypoglycemia','d_hypoglycemia_none','d_hypoglycemia_possible','d_hiv','d_hiv_none','d_hiv_not_tested','d_hiv_susceptible','d_hiv_to_test_mother','d_hiv_to_test','as_danger','d_fever','d_illness_severe_malaria_possible','d_illness_severe_no_malaria','d_illness_fever_severe_malaria_possible','d_illness_fever_severe_malaria_to_test','d_illness_fever_severe_persistent','d_illness_fever_severe_persistent_malaria_to_test','d_meningitis_no_malaria','d_malaria_neuro','d_malaria_severe','d_malaria','d_malaria_possible','d_meningitis_malaria_to_test','d_malaria_to_test','d_illness_severe_malaria_to_test','d_tuberculosis_possible','d_conjunctivitis_treat','d_conjunctivitis_observe','d_drepanocytosis','d_hepatitis_possible','d_hepatitis_to_test','d_hepatitis','d_hepatitis_persistent','d_wheezing_to_follow','d_wheezing_recurent','d_wheezing_resistant_possible','d_pneumonia_severe','d_pneumonia','d_abdomen_acute','d_acute_intestinal_invagination','p_age','p_weight','p_weight_age','p_weight_class','d_convulsion','d_convulsion_epi','a_iv_possible','a_ng_tube_possible_ds','d_malnutrition_severe_complex','d_malnutrition_severe_simple','d_malnutrition_severe_possible','d_malnutrition_moderate','d_malnutrition_cannot_assess','d_malnutrition_none','d_malnutrition_severe','d_ictere','d_anemia_moderate_to_test','d_anemia_severe_to_test','d_anemia_severe_possible','d_anemia_severe','d_anemia_moderate','as_meningitis','d_cellulite_erysipelas_refer','d_abscess_refer','d_abscess','d_boils_or_small_abscess','d_cellulite_erysipelas','d_meningococcal_septicemia_possible','d_skin_problem_no_category','d_seborrhoeic_dermatitis','d_ringworm_head','d_kerion','d_head_lice','d_impetigo','d_impetigo_extensive','d_herpes','d_body_ringworm_localised','d_folliculitis','d_ulcer_refer','d_ulcere','d_dracunculiasis','d_lepre_possible','d_pityriasis_versicolour','d_pityriasis_alba','d_molloscum_contagiosum','d_zona','d_meningococcal_scepticism_possible','d_varicella','d_varicella_superinfected','d_fever_scarlet','d_benign_viral_rash_possible','d_urticaria','d_scabies','d_scabies_superinfected','d_body_ringworm_extensive','d_eczema_extensive','d_eczema','d_eczema_extensive_superinfected','d_skin_problem_not_diagnosed','d_vision_loss','d_eye_injury','d_orbital_cellulitis','d_preseptal_cellulitis','d_simple_headache','d_serious_brain_problem','d_referral_head','d_migraine','d_simple_head_trauma','d_flu','d_simple_headache_sinusitis_viral','d_sinusitis_bacterial','d_ear_infection_to_treat','d_mastoidity','d_ear_infection_w_discharge','d_ear_infection_chronic','d_ear_infection','d_ear_wax','d_ear_severe_head_trauma','d_ear_foreign_obj','d_ear_other','d_epilepsy_known','d_postictal_state','d_epilepsy_likely','d_convulsion_with_febrile_sickness','d_first_convulsion_non_febrile','d_upper_resp_infection_severe','d_angina_possible','d_angina_to_test','d_angina','d_pharyngitis_viral','d_oral_candida','d_eruption_tooth','d_dental_cavity','d_oral_ulcer','d_viral_infection_oral','d_gingivite','d_oral_trauma','d_mastoiditis','d_foreign_body','d_circumcision_infection','d_hemorrhage_vaginale_observe','d_possible_start_of_period','as_is_vaginal_discharge','d_urine_test_f','d_urine_test_m','as_is_red_swollen_tender_testicles','as_is_bloody_urine_or_hematoria_history','as_is_ulceration_or_irritation','as_is_mucopurulent_discharge_m','d_testicular_torsion_probably','d_testicular_infection_treat','d_post_circumcision_infection_probable','d_balanitis','d_urethritis','d_lower_urinary_tract_infection','as_is_suspicion_lower_urinary_tract_infection','d_pyelonephritis','d_urin_retention','d_anuria','d_anuria_referral','d_trauma_genital','d_diaper_rash','d_bilharzia_to_test','d_vesical_bilharzia','d_hematuria_persistent','d_kidney_problem_post_streptococcal_infection_posible','d_sickle_cell_disease_possible','d_hematuria_observe','as_is_hiv_test_irritation_ulcerations','d_herpes_genital_observe','d_syphilis_and_chancre_mou','d_oxyure_and_candida_likely','d_candida','d_genital_discharge_observe','d_dehydration_severe','d_dehydration','d_upper_resp_infection','d_herpetic_keratitis','d_trachoma_possible','d_cornea_abrasion_possible','d_measles_past','d_measles_present_past','d_measles_mouth_ulcers','d_ano_rectal_cleft','d_hemorrhoids','d_rectal_prolapse','d_stool_blood','d_stool_blood_episode','d_intoxication_high_risk_refer','d_ingestion_non_complicated','d_intoxication_substance_unknown','d_intoxication_alcoholic','as_substance_ingired','d_selfagression_suicide_likely','d_agression_suicide_unlikely','d_emotional_and_substance_use_management','d_agression_suicide_none','dgh_antiparasites','d_hypoglycemia','d_hypoglycemia_none','d_hypoglycemia_possible','d_hiv','d_hiv_possible','d_hiv_none','d_hiv_not_tested','d_hiv_susceptible','d_hiv_to_test_mother','d_hiv_to_test','as_danger','d_fever','d_illness_severe_malaria_possible','d_illness_severe_no_malaria','d_illness_fever_severe_malaria_possible','d_illness_fever_severe_malaria_to_test','d_illness_fever_severe_persistent','d_illness_fever_severe_persistent_malaria_to_test','d_meningitis_no_malaria','d_malaria_neuro','d_malaria_severe','d_malaria','d_malaria_possible','d_meningitis_malaria_to_test','d_malaria_to_test','d_illness_severe_malaria_to_test','d_tuberculosis_possible','d_conjunctivitis_treat','d_conjunctivitis_observe','d_drepanocytosis','d_hepatitis_possible','d_hepatitis_to_test','d_hepatitis','d_hepatitis_persistent','d_wheezing_to_follow','d_wheezing_recurent','d_wheezing_resistant_possible','d_pneumonia_severe','d_pneumonia','d_abdomen_acute','d_acute_intestinal_invagination','d_diarrhoea_severe','d_diarrhoea_cholera','d_diarrhoea_severe_persistent','d_diarrhoea_watery','d_diarrhoea_persistent','d_diarrhoea_persistent_bloody','d_constipation','d_intestinal_parasite','d_gastroenterite_possible','d_intoxication','d_dysentery','d_dysentery_severe','d_intestinal_bilharziasis','p_height','dga_is_salbutamol_spray','d_diarrhoea_severe','d_diarrhoea_cholera','d_diarrhoea_severe_persistent','d_diarrhoea_watery','d_diarrhoea_persistent','d_diarrhoea_persistent_bloody','d_constipation','d_intestinal_parasite','d_gastroenterite_possible','d_intoxication','d_dysentery','d_dysentery_severe','d_intestinal_bilharziasis','p_height','dga_is_salbutamol_sget_stylepray'];e.exports={TASK_FORM:'pcmie_test_diag',generateIMCIContent:function(e,t,_){console.log('generateIMCIContent'),i(e,'_case_',s,a,[_]),console.log('generateIMCIContent Done')},getIMCIContactLabel:function(e,t){r(t,'p_age'),r(t,'g_reg.p_weight'),r(t,'g_pause_required.text_end')},IMCIappliesIf:function(e,t){return!!r(t,'g_pause_required.ask_pause')&&('Yes'===r(t,'g_pause_required.ask_pause')&&''===r(t,'source_id'))},IMCIresolveIf:function(e,t,_,i){const a=Math.max(n(i,-_.start).getTime(),t.reported_date),s=n(i,_.end+1).getTime(),o=['pcmie_test_diag'];return e.reports.filter(e=>o.includes(e.form)).filter(e=>e.reported_date>=a&&e.reported_date<=s).filter(e=>r(e,'source_id')===t._id).length>0}}},function(e,t){function _(e,t,_){var r,n={};for(t.forEach((function(e){n[e[0]]=null})),r=0;r<e.length;++r){const a=e[r];a&&_.includes(a.form)&&a.fields&&(n=i(n,a.fields,t))}return n}function i(e,t,_){for(const[r,n]of Object.entries(t))isNaN(r)&&null!=n&&'meta'!==r&&void 0!==r&&('object'==typeof n&&Object.getOwnPropertyNames(n).length>0?e=i(e,n,_):_.includes(r)&&(e[r]=n));return e}e.exports={dateFormat:function(e,t=!1){let _=new Date(e),i=_.getDate(),r=_.getMonth()+1,n=_.getFullYear();return t?`${n}-${r}-${i}`:`${i}/${r}/${n}`},getAgeInYears:function(e){var t,_;if(e.date_of_birth&&''!==e.date_of_birth)return t=new Date(e.date_of_birth),_=new Date(Date.now()-t.getTime()),Math.abs(_.getFullYear()-1970)},addDatas:i,initDatas:_,isReportValid:function(e){return e&&!(e.errors&&e.errors.length)},injectDataFromForm:function(e,t,i,r,n=[]){var a=_(n,i,r);Object.entries(a).forEach(([_,i])=>{null!==i&&(e[t+_]=i)})},isDate:function(e){return null!=e&&'Invalid Date'!==new Date(e)&&!isNaN(new Date(e))},hasValue:function(e){return null!=e&&''!==e},getBirthDate:function(e){var t=e&&(e.birth_date||e.fields.birth_date||e.reported_date);return new Date(t)},count:function(e,t){for(var _=0,i=0;i<e.length;++i)t(e[i])&&++_;return _},truncateDecimals:function(e,t){var _=e.toString(),i=_.indexOf('.'),r=-1===i?_.length:1+i+t,n=_.substr(0,r),a=isNaN(n)?0:n;return parseFloat(a)}}},function(e,t){const _=l(Date.now()),i=['pregnancy'],r=['delivery'],n=['pregnancy_home_visit'],a=['pregnancy','pregnancy_home_visit','pregnancy_facility_visit_reminder','pregnancy_danger_sign','pregnancy_danger_sign_follow_up','delivery'];const s=(e,t)=>['fields',...(t||'').split('.')].reduce((e,t)=>{if(void 0!==e)return e[t]},e);function o(e,t){let _;return e.forEach((function(e){t.includes(e.form)&&!e.deleted&&(!_||e.reported_date>_.reported_date)&&(_=e)})),_}function d(e){if(!e)return new Date;const t=e.split(/\\D/),_=new Date(t[0],t[1]-1,t[2]);return function(e){return e instanceof Date&&!isNaN(e)}(_)?_:new Date}function c(e){const t=new Date(e);return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t}function l(e){if('string'==typeof e){if(''===e)return null;e=d(e)}return c(e).getTime()}function u(e,t){const _=c(new Date(e));return _.setDate(_.getDate()+t),_}function p(e){return i.includes(e.form)}function f(e){return n.includes(e.form)}const m=function(e,t){let _;return e.forEach((function(e){t.includes(e.form)&&(!_||e.reported_date>_.reported_date)&&(_=e)})),_},h=function(e){return p(e)&&l(s(e,'lmp_date_8601'))};function v(e,t){return e.reports.filter((function(e){let _=h(t);return _||(_=t.reported_date),f(e)&&e.reported_date>t.reported_date&&e.reported_date<u(_,294)}))}function g(e,t){let _=h(t),i=t.reported_date;return v(e,t).forEach((function(e){const t=function(e){return f(e)&&l(s(e,'lmp_date_8601'))}(e);e.reported_date>i&&''!==t&&t!==_&&(i=e.reported_date,_=t)})),_}e.exports={today:_,MS_IN_DAY:864e5,MAX_DAYS_IN_PREGNANCY:294,addDays:u,isAlive:function(e){return e&&e.contact&&!e.contact.date_of_death},getTimeForMidnight:c,isFormArraySubmittedInWindow:function(e,t,_,i,r){let n=!1,a=0;return e.forEach((function(e){t.includes(e.form)&&e.reported_date>=_&&e.reported_date<=i&&(n=!0,r&&a++)})),r?a>=r:n},isFormArraySubmittedInWindowExcludingThisReport:function(e,t,_,i,r,n){let a=!1,s=0;return e.forEach((function(e){t.includes(e.form)&&e.reported_date>=_&&e.reported_date<=i&&e._id!==r._id&&(a=!0,n&&s++)})),n?s>=n:a},getDateMS:l,getDateISOLocal:d,isDeliveryForm:function(e){return r.includes(e.form)},getMostRecentReport:o,getNewestPregnancyTimestamp:function(e){if(!e.contact)return;const t=o(e.reports,'pregnancy');return t?t.reported_date:0},getNewestDeliveryTimestamp:function(e){if(!e.contact)return;const t=o(e.reports,'delivery');return t?t.reported_date:0},getReportsSubmittedInWindow:function(e,t,_,i,r){const n=[];return e.forEach((function(e){t.includes(e.form)&&e.reported_date>=_&&e.reported_date<=i&&(r&&!r(e)||n.push(e))})),n},countReportsSubmittedInWindow:function(e,t,_,i,r){let n=0;return e.forEach((function(e){t.includes(e.form)&&e.reported_date>=_&&e.reported_date<=i&&(r&&!r(e)||n++)})),n},countANCFacilityVisits:function(e,t){let _=0;const i=v(e,t);return s(t,'anc_visits_hf.anc_visits_hf_past')&&!isNaN(s(t,'anc_visits_hf.anc_visits_hf_past.visited_hf_count'))&&(_+=parseInt(s(t,'anc_visits_hf.anc_visits_hf_past.visited_hf_count'))),_+=i.reduce((function(e,t){const _=s(t,'anc_visits_hf.anc_visits_hf_past');return _?(e+='yes'===_.last_visit_attended&&1,isNaN(_.visited_hf_count)?e:e+('yes'===_.report_other_visits&&parseInt(_.visited_hf_count))):0}),0),_},isFacilityDelivery:function(e,t){return!!e&&(1===arguments.length&&(t=e),'yes'===s(t,'facility_delivery'))},getMostRecentLMPDateForPregnancy:g,getNewestReport:m,getSubsequentPregnancyFollowUps:v,isActivePregnancy:function(e,t){if(!p(t))return!1;const i=(g(e,t)||t.reported_date)>_-254016e5,r=function(e,t,i){return e.reports.filter((function(e){return'delivery'===e.form&&e.reported_date>t.reported_date&&(!i||t.reported_date>=_-864e5*i)}))}(e,t,42).length>0,a=function(e,t){return e.reports.filter((function(e){return p(e)&&e.reported_date>t.reported_date}))}(e,t).length>0;return i&&!r&&!a&&!function(e,t){const _=v(e,t),i=m(_,n);return i&&'abortion'===s(i,'pregnancy_summary.visit_option')}(e,t)&&!function(e,t){const _=v(e,t),i=m(_,n);return i&&'miscarriage'===s(i,'pregnancy_summary.visit_option')}(e,t)},getRecentANCVisitWithEvent:function(e,t,_){const i=v(e,t),r=m(i,n);if(r&&s(r,'pregnancy_summary.visit_option')===_)return r},isPregnancyTaskMuted:function(e){const t=m(e.reports,a);return t&&f(t)&&'clear_all'===s(t,'pregnancy_ended.clear_option')},getField:s,getConditionValue:function(e,t,_){if(s(t,_)){const e=s(t,_).valueOf();return parseInt(e)}},hasCondition:function(e,t,_){if(s(t,_)){const e=s(t,_).valueOf();return'1'===e||'yes'===e.toLowerCase()}return!1}}},function(e,t){e.exports=[]},function(e,t,_){var i=_(0),r=_(8);function n(e,t,_,i,r,n){var a;if(e.appliesToType){var s;if('contacts'===e.appliesTo){if(!r.contact)return;s='contact'===r.contact.type?r.contact.contact_type:r.contact.type}else{if(!n)return;s=n.form}if(-1===e.appliesToType.indexOf(s))return}if('scheduled_tasks'===e.appliesTo||!e.appliesIf||e.appliesIf(r,n))if('scheduled_tasks'===e.appliesTo){if(n&&e.appliesIf){if(!n.scheduled_tasks)return;for(a=0;a<n.scheduled_tasks.length;a++)e.appliesIf(r,n,a)&&d(a)}}else d();function o(e,t,_){var i;return(i='function'==typeof e.contactLabel?e.contactLabel(t,_):e.contactLabel)?{name:i}:t.contact}function d(a){var s,d,l,u,p=null;for(s=0;s<e.events.length;s++){if((d=e.events[s]).dueDate)p=d.dueDate(d,r,n,a);else if(n)p=void 0!==a?new Date(t.addDate(new Date(n.scheduled_tasks[a].due),d.days)):new Date(t.addDate(new Date(n.reported_date),d.days));else if(d.dueDate)p=d.dueDate(d,r);else{var f=r.contact&&r.contact.reported_date?new Date(r.contact.reported_date):new Date;p=new Date(t.addDate(f,d.days))}t.isTimely(p,d)&&(u={_id:(n?n._id:r.contact&&r.contact._id)+'~'+(d.id||s)+'~'+e.name,deleted:!(!(r.contact&&r.contact.deleted||n)||!n.deleted),doc:r,contact:o(e,r,n),icon:e.icon,date:p,readyStart:d.start||0,readyEnd:d.end||0,title:e.title,resolved:e.resolvedIf(r,n,d,p,a),actions:c(e.actions,d)},void 0!==a&&(u._id+='-'+a),'function'==typeof(l=e.priority)&&(l=l(r,n)),l&&(u.priority=l.level,u.priorityLabel=l.label),i('task',new _(u)))}}function c(t,_){return e.actions.map((function(e){return function(e,t){var _={source:'task',source_id:n?n._id:r.contact&&r.contact._id,contact:r.contact};e.modifyContent&&e.modifyContent(_,r,n,t);return{type:e.type||'report',form:e.form,label:e.label||'Follow up',content:_}}(e,_)}))}}e.exports=function(e,t,_,a,s){if(e)for(var o,d,c=0;c<e.length;++c)switch('function'!=typeof(o=Object.assign({},e[c],r)).resolvedIf&&(o.resolvedIf=function(e,t,i,r){return o.defaultResolvedIf(e,t,i,r,_)}),i(o),o.appliesTo){case'reports':case'scheduled_tasks':for(var l=0;l<t.reports.length;++l)d=t.reports[l],n(o,_,a,s,t,d);break;case'contacts':t.contact&&n(o,_,a,s,t);break;default:throw new Error('Unrecognised task.appliesTo: '+o.appliesTo)}}},function(e,t){e.exports={defaultResolvedIf:function(e,t,_,i,r){var n,a;r||(r=Utils);var s=function(e){var t;if(!e||!e.actions)return;return(t=e.actions.find((function(e){return!e.type||'report'===e.type})))&&t.form}(this.definition);if(!s)throw new Error('Could not find the default resolving form!');return n=0,n=t?Math.max(r.addDate(i,-_.start).getTime(),t.reported_date+1):r.addDate(i,-_.start).getTime(),a=r.addDate(i,_.end+1).getTime(),r.isFormSubmittedInWindow(e.reports,s,n,a)}}},function(e,t,_){var i=_(0);function r(e,t,_,i,r,n){var a=!!n;if(r.contact){var s='contact'===r.contact.type?r.contact.contact_type:r.contact.type,o=a?n.form:s;if(!(e.appliesToType&&e.appliesToType.indexOf(o)<0)&&(!e.appliesIf||e.appliesIf(r,n)))for(var d=a?n:r.contact,c=function(e,t,_){var i;return i='function'==typeof e.idType?e.idType(t,_):'report'===e.idType?_&&_._id:t.contact&&t.contact._id,Array.isArray(i)||(i=[i]),i}(e,r,n),l=!e.passesIf||!!e.passesIf(r,n),u=function(e,t,_,i){if('function'==typeof e.date)return e.date(_,i)||t.now().getTime();if(void 0===e.date||null===e.date||'now'===e.date)return t.now().getTime();if('reported'===e.date)return i?i.reported_date:_.contact.reported_date;throw new Error('Unrecognised value for target.date: '+e.date)}(e,_,r,n),p=e.groupBy&&e.groupBy(r,n),f=0;f<c.length;++f){var m=new t({_id:c[f]+'~'+e.id,contact:r.contact,deleted:!!d.deleted,type:e.id,pass:l,groupBy:p,date:u});e.emitCustom?e.emitCustom(h,m,r,n):h(m)}}function h(e){i('target',e)}}e.exports=function(e,t,_,n,a){for(var s=0;s<e.length;++s){var o=e[s];switch(i(o),o.appliesTo){case'contacts':r(o,n,_,a,t);break;case'reports':for(var d=0;d<t.reports.length;++d){r(o,n,_,a,t,t.reports[d])}break;default:throw new Error('Unrecognised target.appliesTo: '+o.appliesTo)}}}}]); }\n}",
    "targets": {
      "enabled": true,
      "items": []
    }
  }
}
